const geoNameApi_key="sanskriti",weatherbitApi_key="1613a45182184f6789fb10b35db62e04",pixabayApi_key="22470635-1ba3c76934d3d6f03ec806aaf",performAction=async()=>{const e=document.getElementById("city").value,t=document.querySelector(".warning"),a=document.querySelector(".depart").value,o=document.querySelector(".return").value;let n=new Date;const r=Math.floor((new Date(a).getTime()-n.getTime())/864e5),i=Math.ceil((new Date(o).getTime()-new Date(a).getTime())/864e5);document.querySelector(".tripInfo").innerHTML=`Your trip is ${r} days away and will be for a period of ${i} days`,e?(console.log(`city name: ${e}`),getDatafromGeonames(e).then((e=>postData("http://localhost:8081/geonames",{latitude:e.geonames[0].lat,longitude:e.geonames[0].lng,country:e.geonames[0].countryName,city:e.geonames[0].name}).then((e=>({lat:e[e.length-1].latitude,lng:e[e.length-1].longitude}))).then((({lat:e,lng:t})=>getDatafromWeatherbit(e,t))).then((e=>postData("http://localhost:8081/weatherbit",{high:e.data[0].high_temp,low:e.data[0].low_temp,description:e.data[0].weather.description}))))).then((()=>getDatafromPixabay(e))).then((e=>postData("http://localhost:8081/pixabay",{image:e.hits[0].webformatURL}))).then(updateUI()).then(document.getElementById("generate").addEventListener("click",changeUI)),t.classList.remove("show")):(t.classList.add("show"),t.innerHTML="Please enter a City")},getDatafromGeonames=async e=>{const t=`http://api.geonames.org/searchJSON?q=${e}&maxRows=1&username=sanskriti`,a=await fetch(t);try{return await a.json()}catch(e){console.log(e,"Geonames error")}},getDatafromWeatherbit=async(e,t)=>{const a=`http://api.weatherbit.io/v2.0/forecast/daily?key=${weatherbitApi_key}&lat=${e}&lon=${t}`,o=await fetch(a);try{return await o.json()}catch(e){console.log(e,"weatherbit error")}},getDatafromPixabay=async e=>{const t=`https://pixabay.com/api/?q=${e}&key=${pixabayApi_key}`,a=await fetch(t);try{return await a.json()}catch(e){console.log(e,"weatherbit error")}},postData=async(e="",t={})=>{const a=await fetch(e,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});try{return await a.json()}catch(e){console.log("error",e)}},updateUI=async()=>{const e=await fetch("http://localhost:8081/data");try{const t=await e.json();console.log(t),document.querySelector(".place").innerHTML=`Your beautiful destination is ${t[t.length-3].city},\n        ${t[t.length-3].country}.`,document.querySelector(".tripDetails").innerHTML=`The Weather Forecast: <br> ${t[t.length-2].description} <br>\n                                               High: ${t[t.length-2].high} °C \n                                               Low: ${t[t.length-2].low} °C`,document.querySelector(".image").src=t[t.length-1].image}catch(e){console.log("error",e)}},changeUI=()=>{document.getElementById("city").value="",document.getElementById("dep").value="",document.getElementById("ret").value=""};document.getElementById("generate").addEventListener("click",performAction);export{getDatafromGeonames};export{getDatafromWeatherbit};export{getDatafromPixabay};export{performAction};export{postData};export{updateUI};export{changeUI};