(()=>{"use strict";const e=async(e="",t={})=>{const a=await fetch(e,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});try{return await a.json()}catch(e){console.log("error",e)}},t=()=>{document.getElementById("city").value="",document.getElementById("dep").value="",document.getElementById("ret").value=""};document.getElementById("generate").addEventListener("click",(async()=>{const a=document.getElementById("city").value,n=document.querySelector(".warning"),o=document.querySelector(".depart").value,r=document.querySelector(".return").value;let c=new Date;const i=Math.floor((new Date(o).getTime()-c.getTime())/864e5),l=Math.ceil((new Date(r).getTime()-new Date(o).getTime())/864e5);document.querySelector(".tripInfo").innerHTML=`Your trip is ${i} days away and will be for a period of ${l} days`,a?(console.log(`city name: ${a}`),(async e=>{const t=`http://api.geonames.org/searchJSON?q=${e}&maxRows=1&username=sanskriti`,a=await fetch(t);try{return await a.json()}catch(e){console.log(e,"Geonames error")}})(a).then((t=>e("http://localhost:8081/geonames",{latitude:t.geonames[0].lat,longitude:t.geonames[0].lng,country:t.geonames[0].countryName,city:t.geonames[0].name}).then((e=>({lat:e[e.length-1].latitude,lng:e[e.length-1].longitude}))).then((({lat:e,lng:t})=>(async(e,t)=>{const a=`http://api.weatherbit.io/v2.0/forecast/daily?key=1613a45182184f6789fb10b35db62e04&lat=${e}&lon=${t}`,n=await fetch(a);try{return await n.json()}catch(e){console.log(e,"weatherbit error")}})(e,t))).then((t=>e("http://localhost:8081/weatherbit",{high:t.data[0].high_temp,low:t.data[0].low_temp,description:t.data[0].weather.description}))))).then((()=>(async e=>{const t=`https://pixabay.com/api/?q=${e}&key=22470635-1ba3c76934d3d6f03ec806aaf`,a=await fetch(t);try{return await a.json()}catch(e){console.log(e,"weatherbit error")}})(a))).then((t=>e("http://localhost:8081/pixabay",{image:t.hits[0].webformatURL}))).then((async()=>{const e=await fetch("http://localhost:8081/data");try{const t=await e.json();console.log(t),document.querySelector(".place").innerHTML=`Your beautiful destination is ${t[t.length-3].city},\n        ${t[t.length-3].country}.`,document.querySelector(".tripDetails").innerHTML=`The Weather Forecast: <br> ${t[t.length-2].description} <br>\n                                               High: ${t[t.length-2].high} °C \n                                               Low: ${t[t.length-2].low} °C`,document.querySelector(".image").src=t[t.length-1].image}catch(e){console.log("error",e)}})()).then(document.getElementById("generate").addEventListener("click",t)),n.classList.remove("show")):(n.classList.add("show"),n.innerHTML="Please enter a City")}))})();
